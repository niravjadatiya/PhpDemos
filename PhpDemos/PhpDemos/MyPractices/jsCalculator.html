<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Calculator</title>
    <style media="screen">
        #calculator {
            position: relative;
            background-color: SlateGray;
            width: 300px;
            height: 340px;
            border: 3px solid SlateGray;
            padding: 1%;
            margin: 7% auto;
            border-radius: 15px;
            box-shadow: 5px 5px 15px 5px #888;
        }

        input[type="button"] {
            width: 100%;
            height: 100%;
            background-color: black;
            border: none;
            color: white;
            font-size: 110%;
            font-weight: bold;
            border-radius: 10px;
        }

        input[type="button"]:hover {
            background-color: Maroon;
        }

        textarea:focus,
        input:focus {
            outline: none;
        }

        #ac {
            background-color: darkblue;
        }

        #ac:hover {
            background-color: Maroon;
        }

        input[type="text"] {
            font-size: 140%;
            width: 98.5%;
            height: 100%;
            text-align: right;
            border-radius: 5px;
        }

        #percentage {
            font-size: 75%;
            font-weight: bold;
        }

         ::-webkit-input-placeholder {
            color: black;
        }
    </style>

</head>

<body style="background-color:silver;" onkeypress="escFuntion(event)">

    <form Name="formCalc" width="100%" onsubmit="return false">
        <table id="calculator" class="draggable">
            <tr>
                <td colspan="4"><input type="text" placeholder="0" id="placeHolderDisplay" name="calDisplay" onkeypress="if (event.keyCode == 13) {myFunction(event)}" autocomplete="off"></td>

            </tr>
            <tr>
                <td><input type="button" value="7" onclick="operationChecking(7);"></td>
                <td><input type="button" value="8" onclick="operationChecking(8);"></td>
                <td><input type="button" value="9" onclick="operationChecking(9);"></td>
                <td><input type="button" value="/" onclick="operation('/');"></td>
            </tr>
            <tr>
                <td><input type="button" value="4" onclick="operationChecking(4);"></td>
                <td><input type="button" value="5" onclick="operationChecking(5);"></td>
                <td><input type="button" value="6" onclick="operationChecking(6);"></td>
                <td><input type="button" value="*" onclick="operation('*')" ;></td>
            </tr>
            <tr>
                <td><input type="button" value="1" onclick="operationChecking(1);"></td>
                <td><input type="button" value="2" onclick="operationChecking(2);"></td>
                <td><input type="button" value="3" onclick="operationChecking(3);"></td>
                <td><input type="button" value="-" onclick="operation('-');"></td>
            </tr>
            <tr>
                <td><input type="button" value="0" onclick="operationChecking(0);"></td>
                <td><input type="button" value="." onclick="formCalc.calDisplay.value +='.'"></td>

                <td><input type="button" value="<" onclick="backspace();"></td>
                <td><input type="button" value="+" onclick="operation('+');"></td>
            </tr>
            <tr>
                <td><input type="button" value="%" id="percentage" onclick="operation ('%')" </td>
                    <td><input type="button" value=&#8730 onclick="square();"></td>
                    <td colspan="2"><input type="button" value=x&#178; onclick="formCalc.calDisplay.value =formCalc.calDisplay.value * formCalc.calDisplay.value"></td>
            </tr>
            <tr>
                <td colspan="2"><input id="ac" type="button" value="AC" onclick="operation ('AC')"></td>
                <td colspan="2"><input type="button" value="=" onclick="operation ('=')"></td>
                <p id="demo"> here the key</p>
            </tr>
        </table>
    </form>
    <script src="jquery-1.12.4.js"></script>
    <script src="jquery-ui.js"></script>
    <script>
        $(function() {
            $(".draggable").draggable();
        });
    </script>
    <script type="text/javascript">
        // function buttonSelection() {
        //     console.log(document.getElementByTagName(td));
        // }

        function backspace() {
            var s = formCalc.calDisplay.value;
            var str = s.substring(0, s.length - 1);
            return formCalc.calDisplay.value = str;
        }

        function escFuntion(evt) {
            document.onkeydown = function(evt) {
                evt = evt || window.event;
                var isEscape = false;
                if ("key" in evt) {
                    isEscape = (evt.key == "Escape" || evt.key == "Esc");
                } else {
                    isEscape = (evt.keyCode == 27);
                }
                if (isEscape) {
                    // alert("Escape");
                    return formCalc.calDisplay.value = '';
                }
            };
        }

        function square() {
            var s = formCalc.calDisplay.value;
            var root = Math.sqrt(formCalc.calDisplay.value);
            return formCalc.calDisplay.value = root;
        }

        function myFunction(event) {
            event.preventDefault();
            var result = eval(formCalc.calDisplay.value);
            // document.getElementById("demo").innerHTML = result;
            return formCalc.calDisplay.value = result;
        }
        var x;

        function operationChecking(x) {
            console.log("this is value of display:" + formCalc.calDisplay.value);
            if (isOperator) {
                {
                    isDone = false;
                    formCalc.calDisplay.value = x;
                    isOperator = false;
                }
            } else {
                formCalc.calDisplay.value += x;
            }

        }
        var total = 0;
        var op = -1;
        var a = 0;
        var isOperator = false;
        var lastOperator = null;
        var isDone = false;

        function operation(op) {
            this.op = op;

            var display = parseFloat(formCalc.calDisplay.value);
            switch (op) {
                // console.log(op);
                case '+':
                    equal()
                    if (!isDone) {

                        isDone = true;
                        console.log("this is display:" + display);
                        parseFloat(display);
                        parseFloat(total);

                        total = display + total;
                        formCalc.calDisplay.value = parseFloat(total);
                        console.log("this is total:" + total);
                        isOperator = true;
                    }
                    lastOperator = '+';
                    break;

                case '-':
                    equal()
                    if (!isDone) {

                        isDone = true;
                        console.log("this is display:" + display);
                        parseFloat(display);
                        parseFloat(total);

                        total = display - total;
                        formCalc.calDisplay.value = parseFloat(total);
                        console.log("this is total:" + total);
                        isOperator = true;
                    }
                    lastOperator = '-';
                    break;

                case '*':
                    equal()
                    if (!isDone) {
                        isDone = true;
                        if (total === 0) {
                            total = 1;
                        }
                        console.log("this is display:" + display);
                        parseFloat(display);
                        parseFloat(total);

                        total = display * total;
                        formCalc.calDisplay.value = parseFloat(total);
                        console.log("this is total:" + total);
                        isOperator = true;
                    }
                    lastOperator = '*';
                    break;

                case '/':
                    equal()
                    if (!isDone) {
                        isDone = true;
                        if (total === 0) {
                            total = 1;
                        }
                        console.log("this is display:" + display);
                        parseFloat(display);
                        parseFloat(total);

                        total = display / total;
                        formCalc.calDisplay.value = parseFloat(total);
                        console.log("this is total:" + total);
                        isOperator = true;
                    }
                    lastOperator = '/';
                    break;

                case 'AC':
                    isDone = false;
                    isOperator = false;
                    total = 0;
                    total = parseFloat(total);
                    a = 0;

                    lastOperator = null;
                    op = -1;
                    formCalc.calDisplay.value = "";
                    break;
                case '=':
                    equal();
                    break;

                default:
                    total = 123456;
                    console.log(total);
            }
            document.getElementById("demo").innerHTML = total;
            console.log("this is diplay:" + display + "this is total:" + total);
        }

        function equal() {
            if (!isDone) {
                isDone = true;
                console.log("gone ine equals case ");
                var a = formCalc.calDisplay.value;
                total = eval(parseFloat(total) + lastOperator + parseFloat(a));
                formCalc.calDisplay.value = total;
                document.getElementById("demo").innerHTML = eval(parseFloat(total) + lastOperator + parseFloat(a));
                isOperator = true;
                lastOperator = null;
                a = 0;
            }
        }
    </script>
</body>

</html>
